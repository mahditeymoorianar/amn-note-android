 (cd "$(git rev-parse --show-toplevel)" && git apply --3way <<'EOF' 
diff --git a/app/src/main/java/com/teymoorianar/amnnote/ui/note/NoteActivity.kt b/app/src/main/java/com/teymoorianar/amnnote/ui/note/NoteActivity.kt
index ac2a6551fd930d469cf5e2a8febb754d3ae2b5a2..f32ecf7214d5825b32d8bdd50628fa7789c05a52 100644
--- a/app/src/main/java/com/teymoorianar/amnnote/ui/note/NoteActivity.kt
+++ b/app/src/main/java/com/teymoorianar/amnnote/ui/note/NoteActivity.kt
@@ -1,47 +1,200 @@
 package com.teymoorianar.amnnote.ui.note
 
+import android.app.Activity
+import android.content.Context
+import android.content.Intent
 import android.os.Bundle
 import androidx.activity.ComponentActivity
 import androidx.activity.compose.setContent
 import androidx.activity.enableEdgeToEdge
+import androidx.activity.viewModels
+import androidx.compose.foundation.layout.Arrangement
+import androidx.compose.foundation.layout.Column
+import androidx.compose.foundation.layout.Row
 import androidx.compose.foundation.layout.fillMaxSize
+import androidx.compose.foundation.layout.fillMaxWidth
 import androidx.compose.foundation.layout.padding
+import androidx.compose.foundation.rememberScrollState
+import androidx.compose.foundation.verticalScroll
+import androidx.compose.material3.Button
+import androidx.compose.material3.CircularProgressIndicator
+import androidx.compose.material3.ExperimentalMaterial3Api
+import androidx.compose.material3.OutlinedButton
+import androidx.compose.material3.OutlinedTextField
 import androidx.compose.material3.Scaffold
+import androidx.compose.material3.SnackbarHost
+import androidx.compose.material3.SnackbarHostState
 import androidx.compose.material3.Text
+import androidx.compose.material3.TopAppBar
+import androidx.compose.material3.TopAppBarDefaults
 import androidx.compose.runtime.Composable
+import androidx.compose.runtime.LaunchedEffect
+import androidx.compose.runtime.collectAsState
+import androidx.compose.runtime.getValue
+import androidx.compose.runtime.remember
+import androidx.compose.ui.Alignment
 import androidx.compose.ui.Modifier
-import androidx.compose.ui.tooling.preview.Preview
+import androidx.compose.ui.platform.LocalContext
+import androidx.compose.ui.res.stringResource
+import androidx.compose.ui.text.style.TextAlign
+import androidx.compose.ui.unit.dp
+import com.teymoorianar.amnnote.R
 import com.teymoorianar.amnnote.ui.theme.AmnNoteTheme
+import dagger.hilt.android.AndroidEntryPoint
 
+@AndroidEntryPoint
 class NoteActivity : ComponentActivity() {
+
+    private val viewModel: NoteEditorViewModel by viewModels()
+
     override fun onCreate(savedInstanceState: Bundle?) {
         super.onCreate(savedInstanceState)
         enableEdgeToEdge()
         setContent {
             AmnNoteTheme {
-                Scaffold(modifier = Modifier.fillMaxSize()) { innerPadding ->
-                    Greeting(
-                        name = "Android",
-                        modifier = Modifier.padding(innerPadding)
-                    )
+                val uiState by viewModel.state.collectAsState()
+                val snackbarHostState = remember { SnackbarHostState() }
+                val context = LocalContext.current
+                val activity = context as? Activity
+
+                LaunchedEffect(uiState.isSaved, uiState.isDeleted) {
+                    if (uiState.isSaved || uiState.isDeleted) {
+                        activity?.setResult(Activity.RESULT_OK)
+                        activity?.finish()
+                    }
                 }
+
+                LaunchedEffect(uiState.errorMessage) {
+                    val message = uiState.errorMessage
+                    if (!message.isNullOrEmpty()) {
+                        snackbarHostState.showSnackbar(message)
+                        viewModel.dismissMessage()
+                    }
+                }
+
+                NoteEditorScreen(
+                    state = uiState,
+                    snackbarHostState = snackbarHostState,
+                    onTitleChange = viewModel::onTitleChange,
+                    onContentChange = viewModel::onContentChange,
+                    onSaveClick = { viewModel.saveNote() },
+                    onDeleteClick = { viewModel.deleteNote() }
+                )
             }
         }
     }
-}
 
-@Composable
-fun Greeting(name: String, modifier: Modifier = Modifier) {
-    Text(
-        text = "Hello $name!",
-        modifier = modifier
-    )
+    companion object {
+        const val EXTRA_NOTE_ID: String = "extra_note_id"
+
+        fun newIntent(context: Context, noteId: Long = 0L): Intent {
+            return Intent(context, NoteActivity::class.java).apply {
+                if (noteId != 0L) {
+                    putExtra(EXTRA_NOTE_ID, noteId)
+                }
+            }
+        }
+    }
 }
 
-@Preview(showBackground = true)
+@OptIn(ExperimentalMaterial3Api::class)
 @Composable
-fun GreetingPreview() {
-    AmnNoteTheme {
-        Greeting("Android")
+private fun NoteEditorScreen(
+    state: NoteEditorState,
+    snackbarHostState: SnackbarHostState,
+    onTitleChange: (String) -> Unit,
+    onContentChange: (String) -> Unit,
+    onSaveClick: () -> Unit,
+    onDeleteClick: () -> Unit
+) {
+    val scrollState = rememberScrollState()
+
+    Scaffold(
+        modifier = Modifier.fillMaxSize(),
+        topBar = {
+            TopAppBar(
+                title = {
+                    Text(
+                        text = if (state.noteId == 0L) {
+                            stringResource(id = R.string.note_editor_title_new)
+                        } else {
+                            stringResource(id = R.string.note_editor_title_edit)
+                        }
+                    )
+                },
+                colors = TopAppBarDefaults.topAppBarColors()
+            )
+        },
+        snackbarHost = { SnackbarHost(snackbarHostState) }
+    ) { innerPadding ->
+        Column(
+            modifier = Modifier
+                .fillMaxSize()
+                .padding(innerPadding)
+                .padding(16.dp)
+                .verticalScroll(scrollState),
+            verticalArrangement = Arrangement.spacedBy(16.dp)
+        ) {
+            if (state.isLoading) {
+                Row(
+                    modifier = Modifier.fillMaxWidth(),
+                    horizontalArrangement = Arrangement.Center
+                ) {
+                    CircularProgressIndicator()
+                }
+            }
+
+            OutlinedTextField(
+                value = state.title,
+                onValueChange = onTitleChange,
+                modifier = Modifier.fillMaxWidth(),
+                label = { Text(text = stringResource(id = R.string.note_title_label)) },
+                singleLine = true
+            )
+
+            OutlinedTextField(
+                value = state.content,
+                onValueChange = onContentChange,
+                modifier = Modifier.fillMaxWidth(),
+                label = { Text(text = stringResource(id = R.string.note_content_label)) },
+                minLines = 6,
+                maxLines = Int.MAX_VALUE
+            )
+
+            Row(
+                modifier = Modifier.fillMaxWidth(),
+                horizontalArrangement = Arrangement.spacedBy(12.dp),
+                verticalAlignment = Alignment.CenterVertically
+            ) {
+                Button(
+                    onClick = onSaveClick,
+                    enabled = !state.isLoading,
+                    modifier = Modifier.weight(1f)
+                ) {
+                    Text(text = stringResource(id = R.string.save))
+                }
+
+                if (state.noteId != 0L) {
+                    OutlinedButton(
+                        onClick = onDeleteClick,
+                        enabled = !state.isLoading,
+                        modifier = Modifier.weight(1f)
+                    ) {
+                        Text(text = stringResource(id = R.string.delete))
+                    }
+                }
+            }
+
+            if (!state.isLoading && state.noteId == 0L) {
+                Text(
+                    text = stringResource(id = R.string.note_hint_text),
+                    modifier = Modifier
+                        .fillMaxWidth()
+                        .padding(top = 8.dp),
+                    textAlign = TextAlign.Center
+                )
+            }
+        }
     }
-}
\ No newline at end of file
+}
+
 
EOF
)